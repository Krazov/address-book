/*! address-book 24-04-2018 */

!function a(i,u,l){function o(t,e){if(!u[t]){if(!i[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var s=u[t]={exports:{}};i[t][0].call(s.exports,function(e){return o(i[t][1][e]||e)},s,s.exports,a,i,u,l)}return u[t].exports}for(var c="function"==typeof require&&require,e=0;e<l.length;e++)o(l[e]);return o}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.EDIT_CONTACT="edit-contact",n.NEW_CONTACT="new-contact",n.UPDATE_CONTACT="update-contact",n.DELETE_CONTACT="delete-contact",n.DELETE_CONFIRM="delete-confirm",n.DELETE_CANCEL="delete-cancel",n.INIT_LIST="init-list",n.ADD_TO_LIST="add-to-list",n.UPDATE_LIST="update-list",n.REMOVE_FROM_LIST="remove-from-list",n.UPDATE_REQUEST="update-request",n.DELETE_REQUEST="delete-request"},{}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.LAST_ID="last-id",n.ADDRESS_BOOK="address-book"},{}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.notify=n.unsubscribe=n.subscribe=void 0;var r=e("../utils/fp.util.js"),s={};n.subscribe=function(e,t){a(e)||(s[e]=[]),"function"==typeof t&&s[e].push(t)},n.unsubscribe=function(e,t){a(e)&&s[e].splice(s.indexOf(t),1)},n.notify=function(e,t){a(e)&&s[e].forEach(function(e){e(t)})};function a(e){return(0,r.hasProp)(s,e)}},{"../utils/fp.util.js":7}],4:[function(e,t,n){"use strict";var a=e("./constants/channels.js"),r=e("./constants/databases.js"),i=e("./helpers/message-bus.helper.js"),u=e("./services/db.service.js");e("./view-controllers/list.js"),e("./view-controllers/manage.js"),e("./view-controllers/delete.js");var l=(0,u.read)(r.ADDRESS_BOOK,{}),o=(0,u.read)(r.LAST_ID,{value:0}).value;(0,i.notify)(a.INIT_LIST,l),(0,i.subscribe)(a.NEW_CONTACT,function(e){var t=e.name,n=e.surname,r=e.email,s={id:o+=1,name:t,surname:n,email:r};l[o]=s,(0,u.update)({lastId:o,addressBook:l}),(0,i.notify)(a.ADD_TO_LIST,s)}),(0,i.subscribe)(a.UPDATE_CONTACT,function(e){var t=e.id,n=e.name,r=e.surname,s=e.email;l[t]={id:t,name:n,surname:r,email:s},(0,u.update)({addressBook:l}),(0,i.notify)(a.UPDATE_LIST,{id:t,name:n,surname:r,email:s})}),(0,i.subscribe)(a.DELETE_CONFIRM,function(e){var t=e.id;delete l[t],(0,u.update)({addressBook:l}),(0,i.notify)(a.REMOVE_FROM_LIST,{id:t})}),(0,i.subscribe)(a.DELETE_REQUEST,function(e){var t=e.id;(0,i.notify)(a.DELETE_CONTACT,{id:t,contact:l[t]})}),(0,i.subscribe)(a.UPDATE_REQUEST,function(e){var t=e.id;(0,i.notify)(a.EDIT_CONTACT,l[t])})},{"./constants/channels.js":1,"./constants/databases.js":2,"./helpers/message-bus.helper.js":3,"./services/db.service.js":5,"./view-controllers/delete.js":11,"./view-controllers/list.js":12,"./view-controllers/manage.js":13}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.read=n.update=void 0;var r=e("../constants/databases.js"),s=e("../utils/local-storage.util.js");n.update=function(e){var t=e.lastId,n=e.addressBook;t&&(0,s.set)(r.LAST_ID,JSON.stringify({value:t})),n&&(0,s.set)(r.ADDRESS_BOOK,JSON.stringify(n))},n.read=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return(0,s.get)(e)||t}},{"../constants/databases.js":2,"../utils/local-storage.util.js":8}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createItem=void 0;var o=e("../utils/text.util.js"),c=function(e,t,n,r){var s=document.createElement("button");return s.customData={contactId:r,action:n},s.className=e,s.textContent=t,s};n.createItem=function(e){var t,n,r,s=e.id,a=e.name,i=e.surname,u=(e.country,e.email),l=document.createElement("li");return l.className="item",l.appendChild((t=a,n=i,r=u,Object.assign(document.createElement("div"),{className:"item-label",textContent:(0,o.itemText)({name:t,surname:n,email:r})}))),l.appendChild(c("itemEdit","Edit","edit",s)),l.appendChild(c("itemDelete","Delete","delete",s)),l}},{"../utils/text.util.js":9}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.compose=function(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=s.length-1;return s.reduceRight(function(e,t,n){return n===r?t.apply(void 0,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e)):t(e)},t)}},n.hasProp=function(e,t){return e.hasOwnProperty(t)}},{}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=window.localStorage;n.set=function(e,t){r.setItem(e,t)},n.get=function(e){var t=r.getItem(e);return null!=t?JSON.parse(t):null}},{}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.itemText=function(e){var t=e.name,n=e.surname,r=e.country;return t+" "+n+" ("+(void 0===r?"--":r)+"), "+e.email}},{}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.validateName=function(e){return"string"==typeof e&&0<e.length&&/[\w]+/.test(e.replace(/\d/g,""))},n.validateSurname=function(e){if("string"!=typeof e)return!1;var t=e.replace(/\d/g,"");return""===e||/[\w]+/.test(t)},n.validateCountry=function(){return!0};var r=/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/;n.validateEmail=function(e){return"string"==typeof e&&r.test(e)}},{}],11:[function(e,t,n){"use strict";var r=e("../constants/channels.js"),s=e("../helpers/message-bus.helper.js"),a=e("../utils/text.util.js"),i=null,u=document.querySelector(".dialog-delete"),l=u.querySelector(".form"),o=l.querySelector(".id"),c=l.querySelector(".contact-details"),d=l.querySelector(".form-yes"),m=l.querySelector(".form-no"),f=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";o.value=e,c.textContent=(0,a.itemText)(t)},v=function(e){return function(){u.classList.toggle("is-active",e)}},E=v(!0),T=v(!1),p=function(){i=null,l.reset(),f(),T()};(0,s.subscribe)(r.DELETE_CONTACT,function(e){var t=e.id,n=e.contact;f(i=t,n),E()}),d.addEventListener("click",function(e){e.preventDefault(),(0,s.notify)(r.DELETE_CONFIRM,{id:i}),p()}),m.addEventListener("click",function(e){e.preventDefault(),p()})},{"../constants/channels.js":1,"../helpers/message-bus.helper.js":3,"../utils/text.util.js":9}],12:[function(e,t,n){"use strict";var i=e("../constants/channels.js"),u=e("../helpers/message-bus.helper.js"),a=(e("../utils/fp.util.js"),e("../utils/text.util.js")),l=e("../utils/dom.item.util.js"),o={},c=document.querySelector(".list"),r=function(e){var t,n=e.id,r=e.name,s=e.surname,a=e.email,i=(0,l.createItem)({id:n,name:r,surname:s,email:a});o[n]=i,t=i,c.appendChild(t)};(0,u.subscribe)(i.INIT_LIST,function(e){Object.values(e).forEach(r)}),(0,u.subscribe)(i.ADD_TO_LIST,r),(0,u.subscribe)(i.UPDATE_LIST,function(e){var t=e.id,n=e.name,r=e.surname,s=e.email;o[t].querySelector(".item-label").textContent=(0,a.itemText)({name:n,surname:r,email:s})}),(0,u.subscribe)(i.REMOVE_FROM_LIST,function(e){var t=e.id;c.removeChild(o[t]),delete o[t]}),c.addEventListener("click",function(e){var t,n,r=e.target.customData,s=r.action,a=r.contactId;switch(s){case"edit":n=a,(0,u.notify)(i.UPDATE_REQUEST,{id:n});break;case"delete":t=a,(0,u.notify)(i.DELETE_REQUEST,{id:t})}})},{"../constants/channels.js":1,"../helpers/message-bus.helper.js":3,"../utils/dom.item.util.js":6,"../utils/fp.util.js":7,"../utils/text.util.js":9}],13:[function(e,t,n){"use strict";var i=e("../constants/channels.js"),r=e("../../app/utils/validator.util.js"),u=e("../helpers/message-bus.helper.js"),s=e("../utils/fp.util.js"),l=document.querySelector(".dialog-manage"),o=l.querySelector(".form"),a=o.querySelector(".name-container"),c=o.querySelector(".surname-container"),d=o.querySelector(".email-container"),m=o.querySelector(".id"),f=a.querySelector(".name"),v=c.querySelector(".surname"),E=d.querySelector(".email"),T=(0,s.compose)(function(e){return Object.values(e).every(function(e){return 1==e})},function(e){var t=e.name,n=e.surname,r=e.email;return a.classList.toggle("has-error",!t),c.classList.toggle("has-error",!n),d.classList.toggle("has-error",!r),{name:t,surname:n,email:r}},function(e,t,n){return{name:(0,r.validateName)(e),surname:(0,r.validateSurname)(t),email:(0,r.validateEmail)(n)}});o.addEventListener("submit",function(e){e.preventDefault();var t={id:m.value,name:f.value,surname:v.value,email:E.value},n=t.id,r=t.name,s=t.surname,a=t.email;T(r,s,a)&&(n?(0,u.notify)(i.UPDATE_CONTACT,{id:n,name:r,surname:s,email:a}):(0,u.notify)(i.NEW_CONTACT,{name:r,surname:s,email:a}),l.classList.remove("is-active"),m.value="",o.reset())}),(0,u.subscribe)(i.EDIT_CONTACT,function(e){var t=e.id,n=e.name,r=e.surname,s=e.email;m.value=t,f.value=n,v.value=r,E.value=s,l.classList.add("is-active")})},{"../../app/utils/validator.util.js":10,"../constants/channels.js":1,"../helpers/message-bus.helper.js":3,"../utils/fp.util.js":7}]},{},[4]);